(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/content/dynamic/MyDynamic"],{"049b":function(n,t,e){"use strict";(function(n){e("8484"),e("921b");o(e("66fd"));var t=o(e("44e4"));function o(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,e("6e42")["createPage"])},"0516":function(n,t,e){},"44e4":function(n,t,e){"use strict";e.r(t);var o=e("a655"),i=e("8381");for(var c in i)"default"!==c&&function(n){e.d(t,n,function(){return i[n]})}(c);e("7a89");var s,r=e("f0c5"),a=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);t["default"]=a.exports},"7a89":function(n,t,e){"use strict";var o=e("0516"),i=e.n(o);i.a},8381:function(n,t,e){"use strict";e.r(t);var o=e("e931"),i=e.n(o);for(var c in o)"default"!==c&&function(n){e.d(t,n,function(){return o[n]})}(c);t["default"]=i.a},a655:function(n,t,e){"use strict";var o,i=function(){var n=this,t=n.$createElement,e=(n._self._c,n.__map(n.personDynamicList,function(t,e){var o=n._f("getFormatTime")(t.time);return{$orig:n.__get_orig(t),f0:o}}));n.$mp.data=Object.assign({},{$root:{l0:e}})},c=[];e.d(t,"b",function(){return i}),e.d(t,"c",function(){return c}),e.d(t,"a",function(){return o})},e931:function(n,t,e){"use strict";(function(n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=e("587d"),c=e("2f62"),s=e("7429"),r=e("3389");function a(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},o=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(e).filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.forEach(function(t){u(n,t,e[t])})}return n}function u(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var m={data:function(){return{imgUrl:"",currentPageUrl:"",isShowPraise:!1,hasPraise:!1,currentIndex:-1,popStyle:"",hasComment:!1,commentContent:"",showSmilingFace:!1,currentReplyindex:-1,commentPlaceholder:"评论",commentStyle:"",keyboardHeight:253}},computed:a({},(0,c.mapState)(["userInfo","personDynamicList"])),methods:a({},(0,c.mapActions)(["doGetMyDynamicRequest","doGetPersonDynamicRequest"]),{handlerPraise:function(t){var e=this;this.queryMeHasPraise(t),console.time("time");var i=n.createSelectorQuery().in(this);i.select(".right-praise-img".concat(t)).boundingClientRect(function(n){o("log","得到布局位置信息:",n," at components\\content\\dynamic\\MyDynamic.vue:181");var i=n.top;e.popStyle="top: ".concat(i-9,"px; right:45px"),e.$nextTick(function(){setTimeout(function(){e.isShowPraise=!e.isShowPraise,e.currentIndex=t,console.timeEnd("time")},10)})}).exec()},toComment:function(){var n=this;this.$nextTick(function(){n.currentReplyindex=-1,n.commentContent="",n.commentPlaceholder="评论",n.hidePraiseCommentMask(),n.hasComment=!0})},showComment:function(n,t){this.personDynamicList[n].comment[t].user!==this.userInfo.user.userAccount&&(this.commentContent="",this.commentPlaceholder="回复".concat(this.personDynamicList[n].comment[t].userNickname,":"),this.hasComment=!0,this.currentIndex=n,this.currentReplyindex=t)},hidePraiseCommentMask:function(){var n=this;this.$nextTick(function(){n.isShowPraise=!1,o("log","hidePraiseCommentMask"," at components\\content\\dynamic\\MyDynamic.vue:232")})},toPraise:function(){var t=this,e=this.personDynamicList[this.currentIndex],i={account:e.account,LikeAccount:this.userInfo.user.userAccount,friendCircleDynamicId:e.id};(0,r.doDynamicLikeRequest)(i).then(function(e){o("log",e," at components\\content\\dynamic\\MyDynamic.vue:247"),200===e.status?2e3===e.data.code?t.$nextTick(function(){if(t.hasPraise){var n=t.queryMeHasPraise(t.currentIndex);t.personDynamicList[t.currentIndex].likePerson.splice(n,1)}else{var e={};e[t.userInfo.user.userAccount]=t.userInfo.user.nickname,t.personDynamicList[t.currentIndex].likePerson.push(e)}t.hasPraise=!t.hasPraise}):n.showToast({title:"程序走丢了，请稍后重试",icon:"none"}):404===e.status?n.showToast({title:"网络走丢了，请稍后重试",icon:"none"}):n.showToast({title:"程序走丢了，请稍后重试",icon:"none"})}).catch(function(t){o("log",t," at components\\content\\dynamic\\MyDynamic.vue:283"),n.showToast({title:"程序走丢了，请稍后重试",icon:"none"})}),setTimeout(function(){t.hidePraiseCommentMask()},500)},queryMeHasPraise:function(n){var t=this.personDynamicList[n];if(!(t.likePerson.length>0))return this.hasPraise=!1,!1;for(var e=this.userInfo.user.userAccount,o=0;o<t.likePerson.length;o++)for(var i in t.likePerson[o])if(i===e)return this.hasPraise=!0,o},publishComment:function(){this.commentContent&&(-1!==this.currentReplyindex?this.doComment(this.currentReplyindex):this.doComment())},doComment:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.personDynamicList[this.currentIndex],c={user:this.userInfo.user.userAccount,toUser:null!==e?i.comment[e].user:i.account,commentContent:this.commentContent,friendCircleId:i.id,fatherId:null!==e?i.comment[e].commentId:0};(0,r.doCommentRequest)(c).then(function(e){o("log",e," at components\\content\\dynamic\\MyDynamic.vue:340"),200===e.status?2e3===e.data.code?t.$nextTick(function(){t.hasComment=!1;var n=e.data.data[e.data.data.length-1];t.personDynamicList[t.currentIndex].comment.push(n)}):n.showToast({title:"程序走丢了，请稍后重试",icon:"none"}):404===e.status?n.showToast({title:"网络走丢了，请稍后重试",icon:"none"}):n.showToast({title:"程序走丢了，请稍后重试",icon:"none"})}).catch(function(t){n.showToast({title:"程序走丢了，请稍后重试",icon:"none"})})},delOneDynamic:function(){n.showModal({title:"提示",content:"确定删除吗",success:function(t){t.confirm&&n.showToast({title:"已删除",icon:"none"})}})},toFriendInfo:function(t){n.navigateTo({url:"/components/content/friend/FriendInfo?friendAccount=".concat(t)})},handleFocus:function(n){n.detail.height&&(this.keyboardHeight=n.detail.height,o("log",this.keyboardHeight," at components\\content\\dynamic\\MyDynamic.vue:412"))},handleSmilingFace:function(){this.showSmilingFace=!0}}),filters:{getFormatTime:function(n){return(0,i.formatTimeStamp)(n,"yyyy-MM-dd hh:mm")}},onLoad:function(t){t.account?(this.doGetPersonDynamicRequest({friendAccount:t.account}),n.setNavigationBarTitle({title:"".concat(t.friendRemarkName,"的动态")})):this.doGetMyDynamicRequest({account:this.userInfo.user.userAccount}),this.imgUrl=s.imgBaseUrl},created:function(){o("log","created"," at components\\content\\dynamic\\MyDynamic.vue:447")},onPageScroll:function(n){this.isShowPraise&&(this.isShowPraise=!1),this.hasComment&&(-1!==this.currentReplyindex&&(o("log","currentReplyindex=-1"," at components\\content\\dynamic\\MyDynamic.vue:461"),this.currentReplyindex=-1),this.commentContent="",this.hasComment=!1)}};t.default=m}).call(this,e("6e42")["default"],e("0de9")["default"])}},[["049b","common/runtime","common/vendor"]]]);