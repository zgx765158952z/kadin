{"version":3,"sources":["webpack:///E:/learning/kadingapp/pages/index/index.vue?6e79","webpack:///E:/learning/kadingapp/pages/index/index.vue?a937","webpack:///E:/learning/kadingapp/main.js","webpack:///E:/learning/kadingapp/pages/index/index.vue?4438","webpack:///E:/learning/kadingapp/pages/index/index.vue?b309","webpack:///E:/learning/kadingapp/pages/index/index.vue?705c","webpack:///E:/learning/kadingapp/pages/index/index.vue?bf3f","webpack:///E:/learning/kadingapp/pages/index/index.vue"],"names":["createPage","Page","globalData","getApp","components","IndexContent","DefMask","data","nim","count","title","imToken","toToken","receiveMsg","computed","watch","methods","sendMsg","sendText","scene","to","text","done","res","toInteraction","uni","navigateTo","url","connectSocket","account","socketURL","socketTask","complete","console","log","onSocketOpen","onOpen","handleSendSocket","onSocketMessage","onMessage","updateNewest","JSON","parse","startHeartTime","setInterval","send","success","onSocketError","onError","err","onSocketClose","onClose","handleShowMask","$refs","indexMask","isShowMask","tapHideMask","tapShowMask","toReminded","toAddfriend","getAccountImToken","accid","then","status","code","IMController","token","catch","toChooseFriend","onLoad","userInfo","user","userAccount","appStartGetData","rawMessageList","SDK","NIM","getInstance","debug","appKey","promise","transports","onconnect","test","onwillreconnect","ondisconnect","onerror","setTimeout","onShow","onUnload","indexcontent","hidePop","onHide","onNavigationBarButtonTap","options","index"],"mappings":"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","file":"pages/index/index.js","sourcesContent":["import mod from \"-!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1593393281227\n      var cssReload = require(\"E:/HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=0005e436&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"learning/kadingapp/pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=0005e436&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.4.2.20191115.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport IndexContent from './indexCpns/IndexContent'\n//遮罩层\nimport DefMask from '@/components/content/defmask/DefMask.vue'\n\nimport { mapState, mapMutations, mapActions } from 'vuex'\nimport { getAccountImTokenRequest } from '@/network/login.js'\nimport IMController from '@/controller/im.js'\nimport { socketURL } from '@/common/socketConfig.js'\n//测试发消息\nimport SDK from '@/js_sdk/NIM_Weixin_SDK_v7.3.0/NIM_Web_SDK_weixin_v7.3.0.js'\nimport store from '@/vuex/store.js'\n\n\nlet globalData = getApp().globalData\nexport default {\n\tcomponents: {\n\t\tIndexContent,\n\t\tDefMask\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tnim: null,\n\t\t\tcount: 1,\n\t\t\ttitle: 'Hello',\n\t\t\timToken: '',\n\t\t\ttoToken: '',\n\t\t\treceiveMsg: ''\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapState(['userInfo', 'rawMessageList'])\n\t},\n\twatch: {\n\t},\n\tmethods: {\n\t\t...mapMutations(['appStartGetData']),\n\t\t...mapActions(['updateNewest']),\n\t\t//测试发消息\n\t\tsendMsg() {\n\t\t\tthis.nim.sendText({\n\t\t\t\tscene: 'p2p',\n\t\t\t\tto: '1576463907795',\n\t\t\t\ttext: `我是AAAAAA---消息${this.count}`,\n\t\t\t\tdone: res => {\n\t\t\t\t\tthis.count ++\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t\n\t\ttoInteraction() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/components/content/interaction/Interaction'\n\t\t\t})\n\t\t},\n\t\t\n\t\t//webSocket连接\n\t\tconnectSocket(account) {\n\t\t\tlet url = socketURL + account\n\t\t\t\n\t\t\tglobalData.socketTask = uni.connectSocket({\n\t\t\t\turl,\n\t\t\t\tcomplete: res => {\n\t\t\t\t\tconsole.log('socket连接回调', res)\n\t\t\t\t}\n\t\t\t})\n\t\t\t\n\t\t\t// globalData.socketTask = socket.connectSocket({\n\t\t\t// \turl,\n\t\t\t// \tsuccess: res => {\n\t\t\t// \t\tconsole.log('socket成功连接', res)\n\t\t\t// \t},\n\t\t\t// \tfail: err => {\n\t\t\t// \t\tconsole.log('socket连接失败', err)\n\t\t\t// \t},\n\t\t\t// \tcomplete: res => {\n\t\t\t// \t\tconsole.log('socket连接回调', res)\n\t\t\t// \t}\n\t\t\t// })\n\t\t\t\n\t\t},\n\t\t\n\t\tonSocketOpen() {\n\t\t\tglobalData.socketTask.onOpen(res => {\n\t\t\t\tconsole.log('监听socket打开', res)\n\t\t\t\tthis.handleSendSocket('ping') \n\t\t\t})\n\t\t},\n\t\tonSocketMessage() {\n\t\t\tglobalData.socketTask.onMessage(res => {\n\t\t\t\tconsole.log('接收到服务器的socket消息:', res)\n\t\t\t\tif(res.data !== \"点赞评论更新\") {\n\t\t\t\t\tthis.updateNewest(JSON.parse(res.data))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\thandleSendSocket(data) {\n\t\t\tlet startHeartTime = false\n\t\t\tsetInterval(() => { //3000毫秒心跳\n\t\t\t\tglobalData.socketTask.send({\n\t\t\t\t\tdata,\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif(!startHeartTime) {\n\t\t\t\t\t\t\tstartHeartTime = true\n\t\t\t\t\t\t\tconsole.log('socket开始心跳:', res)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}, 3000)\n\t\t},\n\t\tonSocketError() {\n\t\t\tglobalData.socketTask.onError(err => {\n\t\t\t\tconsole.log('监听socket错误:', err)\n\t\t\t})\n\t\t},\n\t\tonSocketClose() { //监听socket关闭\n\t\t\tglobalData.socketTask.onClose(err => {\n\t\t\t\tconsole.log('socket关闭了:', err)\n\t\t\t})\n\t\t},\n\t\t//显示与隐藏遮罩层\n\t\thandleShowMask() {\n\t\t\t// this.$refs.indexMask.isShowMask = !this.$refs.indexMask.isShowMask\n\t\t\tif(this.$refs.indexMask.isShowMask) {\n\t\t\t\tthis.$refs.indexMask.tapHideMask()\n\t\t\t}else {\n\t\t\t\tthis.$refs.indexMask.tapShowMask()\n\t\t\t}\n\t\t},\n\t\t\n\t\ttoReminded() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/components/content/remind/Reminded'\n\t\t\t})\n\t\t},\n\t\ttoAddfriend() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: \"/components/content/addfriend/AddFriend\"\n\t\t\t})\n\t\t},\n\t\t\n\t\t//获取当前帐户的IM的token\n\t\tgetAccountImToken(accid) {\n\t\t\tgetAccountImTokenRequest(`?accid=${accid}`).then(res => {\n\t\t\t\t\n\t\t\t\tif(res.status === 200) {\n\t\t\t\t\tif(res.data.code === 2000) {\n\t\t\t\t\t\tconsole.log('返回我的的token：', res.data.data)\n\t\t\t\t\t\tnew IMController({\n\t\t\t\t\t\t\ttoken: res.data.data,\n\t\t\t\t\t\t\taccount: accid\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.log('错误信息：',err)\n\t\t\t})\n\t\t},\n\t\t\n\t\t//发起群聊\n\t\ttoChooseFriend() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/components/content/chooseFriend/ChooseFriend?type=createGroup'\n\t\t\t})\n\t\t},\n\t\t\n\t},\n\t//页面加载\n\tonLoad() {\n\t\tconsole.log('userInfo', this.userInfo.user.userAccount)\n\t\tthis.appStartGetData(this.userInfo.user.userAccount)\n\t\tconsole.log('rawMessageList index', this.rawMessageList)\n\t\tthis.getAccountImToken(this.userInfo.user.userAccount)\n\t\tgetAccountImTokenRequest('?accid=1576463946323').then(res => {\n\t\t\t\n\t\t\tif(res.status === 200) {\n\t\t\t\tif(res.data.code === 2000) {\n\t\t\t\t\tconsole.log('返回我的的token2：', res.data.data)\n\t\t\t\t\tthis.nim = SDK.NIM.getInstance({\n\t\t\t\t\t\t// 初始化SDK\n\t\t\t\t\t\tdebug: false,\n\t\t\t\t\t\tappKey: 'a59ba9fafb323c6fcc49a5cbf48d369a',\n\t\t\t\t\t\ttoken: res.data.data,\n\t\t\t\t\t\taccount: 1576463946323,\n\t\t\t\t\t\tpromise: true,\n\t\t\t\t\t\ttransports: ['websocket'],\n\t\t\t\t\t\tonconnect: this.test,\n\t\t\t\t\t\tonwillreconnect: this.test,\n\t\t\t\t\t\tondisconnect: this.test,\n\t\t\t\t\t\tonerror: this.test\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}).catch(err => {\n\t\t\tconsole.log('错误信息：',err)\n\t\t})\n\t\t\n\t\t//webSocket连接\n\t\tthis.connectSocket(this.userInfo.user.userAccount)\n\t\tthis.onSocketOpen()\n\t\tthis.onSocketError()\n\t\tsetTimeout(() => {\n\t\t\tthis.onSocketMessage()\n\t\t}, 80)\n\t\t\n\t\t\n\t},\n\tonShow() {\n\t\t// uni.setTabBarBadge({\n\t\t// \tindex: 1,\n\t\t// \ttext: \"1\",\n\t\t// })\n\t\t// uni.showTabBarRedDot({\n\t\t// \tindex: 1\n\t\t// })\n\t},\n\t//页面卸载\n\tonUnload() {\n\t\tconsole.log('onUnload')\n\t\t//隐藏遮罩层\n\t\tthis.$refs.indexMask.tapHideMask()\n\t\t//隐藏弹窗\n\t\tthis.$refs.indexcontent.hidePop()\n\t},\n\t//页面隐藏\n\tonHide() {\n\t\tconsole.log('onHide')\n\t\t//隐藏遮罩层\n\t\tthis.$refs.indexMask.tapHideMask()\n\t\t//隐藏弹窗\n\t\tthis.$refs.indexcontent.hidePop()\n\t},\n\tonNavigationBarButtonTap(options) {\n\t\t//隐藏弹窗\n\t\tthis.$refs.indexcontent.hidePop()\n\t\tif(options.index === 0) {\n\t\t\tthis.handleShowMask()\n\t\t}\n\t}\n\t\n}\n"],"sourceRoot":""}